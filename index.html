
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>flightlog2X - flightlog2x</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#757575">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="assets/extra.css">
    
      <link rel="stylesheet" href="assets/pdf.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="dark-orange">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#flightlog2x" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="flightlog2x" class="md-header__button md-logo" aria-label="flightlog2x" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            flightlog2x
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              flightlog2X
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="flightlog2x" class="md-nav__button md-logo" aria-label="flightlog2x" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    flightlog2x
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          flightlog2X
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        flightlog2X
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flightlog2kml" class="md-nav__link">
    flightlog2kml
  </a>
  
    <nav class="md-nav" aria-label="flightlog2kml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modes" class="md-nav__link">
    Modes
  </a>
  
    <nav class="md-nav" aria-label="Modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flight-mode-track" class="md-nav__link">
    Flight Mode Track
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#colour-gradients" class="md-nav__link">
    Colour Gradients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flight-modes" class="md-nav__link">
    Flight Modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rssi" class="md-nav__link">
    RSSI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-opentx-logs" class="md-nav__link">
    Using OpenTX logs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fl2mqtt" class="md-nav__link">
    fl2mqtt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log2mission" class="md-nav__link">
    log2mission
  </a>
  
    <nav class="md-nav" aria-label="log2mission">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#epsilon-tuning" class="md-nav__link">
    epsilon tuning
  </a>
  
    <nav class="md-nav" aria-label="epsilon tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multirotor-example" class="md-nav__link">
    multirotor example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mission2kml" class="md-nav__link">
    mission2kml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-default-options" class="md-nav__link">
    Setting default options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-bugs-bug-reporting" class="md-nav__link">
    Limitations, Bugs, Bug Reporting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-and-install" class="md-nav__link">
    Build and Install
  </a>
  
    <nav class="md-nav" aria-label="Build and Install">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-media" class="md-nav__link">
    Release media
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-from-source" class="md-nav__link">
    Building from source
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flightlog2kml" class="md-nav__link">
    flightlog2kml
  </a>
  
    <nav class="md-nav" aria-label="flightlog2kml">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modes" class="md-nav__link">
    Modes
  </a>
  
    <nav class="md-nav" aria-label="Modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flight-mode-track" class="md-nav__link">
    Flight Mode Track
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#colour-gradients" class="md-nav__link">
    Colour Gradients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flight-modes" class="md-nav__link">
    Flight Modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rssi" class="md-nav__link">
    RSSI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-opentx-logs" class="md-nav__link">
    Using OpenTX logs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fl2mqtt" class="md-nav__link">
    fl2mqtt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log2mission" class="md-nav__link">
    log2mission
  </a>
  
    <nav class="md-nav" aria-label="log2mission">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#epsilon-tuning" class="md-nav__link">
    epsilon tuning
  </a>
  
    <nav class="md-nav" aria-label="epsilon tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multirotor-example" class="md-nav__link">
    multirotor example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mission2kml" class="md-nav__link">
    mission2kml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-default-options" class="md-nav__link">
    Setting default options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-bugs-bug-reporting" class="md-nav__link">
    Limitations, Bugs, Bug Reporting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-and-install" class="md-nav__link">
    Build and Install
  </a>
  
    <nav class="md-nav" aria-label="Build and Install">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-media" class="md-nav__link">
    Release media
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-from-source" class="md-nav__link">
    Building from source
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="flightlog2x">flightlog2x<a class="headerlink" href="#flightlog2x" title="Permanent link">#</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>A suite of tools to generate beautifully annotated KML/KMZ files (and other data) from <strong><a href="https://github.com/iNavFlight/inav">inav</a></strong> blackbox logs, OpenTX log files (inav S.Port telemetry, some support for OpenTX logs from Ardupilot), BulletGCSS and Aurduplot <code>.bin</code> logs.</p>
<ul>
<li><a href="#flightlog2kml">flightlog2kml</a> - Generates KML/Z file(s) from Blackbox log(s), OpenTX (OTX) and Bullet GCSS logs</li>
<li><a href="#fl2mqtt">fl2mqtt</a> - Generates MQTT data to stimulate the on-line Ground Control Station <a href="https://bulletgcss.fpvsampa.com/">BulletGCSS</a></li>
<li>fl2ltm - If <code>fl2mqtt</code> is installed (typically by hard or soft link) as <code>fl2ltm</code> it generates LTM  (inav's Lightweight Telemetry). This is primarily for use by <a href="https://github.com/stronnag/mwptools">mwp</a> as a unified replay tool for Blackbox, OpenTx, BulletGCSS and Aurduplot <code>.bin</code> logs.</li>
<li><a href="#log2mission">log2mission</a> - Converts a flight log (Blackbox, OpenTx, BulletGCSS, AP) into a valid inav mission. A number of filters may be applied (time, flight mode).</li>
<li><a href="#mission2kml">mission2kml</a> - Generate KML file from inav mission files (and other formats)</li>
</ul>
<h2 id="flightlog2kml">flightlog2kml<a class="headerlink" href="#flightlog2kml" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code>$ flightlog2kml --help
Usage of flightlog2kml [options] file...
  -dms
        Show positions as DD:MM:SS.s (vice decimal degrees) (default true)
  -dump
        Dump log headers and exit
  -efficiency
        Include efficiency layer in KML/Z (default true)
  -energy-unit string
        Energy unit [mah, wh] (default &quot;mah&quot;)
  -extrude
        Extends track points to ground (default true)
  -gradient string
        Specific colour gradient [red,rdgn,yor] (default &quot;yor&quot;)
  -home-alt int
        [OTX] home altitude
  -index int
        Log index
  -interval int
        Sampling Interval (ms) (default 1000)
  -kml
        Generate KML (vice default KMZ)
  -mission string
        Optional mission file name
  -mission-index int
        Optional mission file index (default 1)
  -outdir string
        Output directory for generated KML
  -rebase string
        rebase all positions on lat,lon[,alt]
  -rssi
        Set RSSI view as default
  -split-time int
        [OTX] Time(s) determining log split, 0 disables (default 120)
  -summary
        Just show summary
  -visibility int
        0=folder value,-1=don&#39;t set,1=all on
</code></pre></div>
<p>Multiple logs (with multiple log indices) may be given. A KML/Z will be generated for each file / index.</p>
<p>The output file is named from the base name of the source log file, appended with the index number and <code>.kml</code> or <code>.kmz</code> as appropriate. For example:</p>
<p><div class="highlight"><pre><span></span><code>$ flightlog2kml LOG00044.TXT
Log      : LOG00044.TXT / 1
Flight   : &quot;Model&quot; on 2020-04-12T14:24:01.410+03:00
Firmware : INAV 2.4.0 (bcd4caef9) MATEKF722 of Feb 11 2020 22:48:59
Size     : 19.36 MB
Altitude : 292.8 m at 25:42
Speed    : 28.0 m/s at 13:54
Range    : 17322 m at 14:22
Current  : 30.6 A at 00:05
Distance : 48437 m
Duration : 43:44
Disarm   : Switch
</code></pre></div>
results in the KMZ file "LOG00044.1.kmz"</p>
<p>Where <code>-mission &lt;file&gt;</code> is given, the given waypoint <code>&lt;mission file&gt;</code> will be included in the generated KML/Z; mission files may be one of the following formats as supported by <a href="https://github.com/stronnag/impload">impload</a>:</p>
<ul>
<li>MultiWii / XML mission files (MW-XML) <a href="https://github.com/stronnag/mwptools">mwp</a>, <a href="https://github.com/iNavFlight/inav-configurator">inav-configurator</a>, <a href="https://play.google.com/store/apps/details?id=com.ezio.multiwii&amp;hl=en_GB">ezgui</a>, <a href="https://play.google.com/store/apps/details?id=com.eziosoft.ezgui.inav&amp;hl=en">mission planner for inav</a>, drone-helper).</li>
<li><a href="https://github.com/stronnag/mwptools/">mwp JSON files</a></li>
<li><a href="https://ardupilot.org/planner2/">apmplanner2</a> "QGC WPL 110" text files</li>
<li><a href="http://qgroundcontrol.com/">qgroundcontrol</a> JSON plan files</li>
<li>GPX and CSV (as described in the <a href="https://github.com/stronnag/impload/wiki/impload-User-Guide">impload user guide</a>)</li>
</ul>
<p>If you use a format other than MW-XML or <a href="https://github.com/stronnag/mwptools">mwp</a> JSON, it is recommended that you review any relevant format constraints as described in the <a href="https://github.com/stronnag/impload/wiki/impload-User-Guide">impload user guide</a>.</p>
<p>For inav 4.0 multi-mission files, <code>-mission-index</code> may be used to define which segment of a multi-mission file to use (1 based).</p>
<h3 id="output">Output<a class="headerlink" href="#output" title="Permanent link">#</a></h3>
<p>KML/Z file defining tracks which may be displayed Google Earth. Tracks can be animated with the time slider.</p>
<p>Both Flight Mode and RSSI tracks are generated; the default for display is Flight Mode, unless <code>-rssi</code> is specified (and RSSI data is available in the log). The log summary is displayed by double clicking on the <code>file name</code> folder in Google Earth.</p>
<h3 id="modes">Modes<a class="headerlink" href="#modes" title="Permanent link">#</a></h3>
<p><code>flightlog2kml</code> can generate three distinct colour-coded outputs:</p>
<ul>
<li>Flight mode: the default, colours as <a href="#flight_mode_track">below</a>.</li>
<li>RSSI mode: RSSI percentage as a colour gradient, according to the current <code>--gradient</code> setting. Note that if no valid RSSI is found in the log, this mode will be suppressed.</li>
<li>Efficiency mode: The efficiency (mAh/km) as a colour gradient,  according to the current <code>--gradient</code> setting. This is not enabled by default, and requires the <code>--efficiency</code> setting to be specified, either as a command line option or permanently in the <a href="#setting-default-options">configuration file</a>.</li>
</ul>
<h4 id="flight-mode-track">Flight Mode Track<a class="headerlink" href="#flight-mode-track" title="Permanent link">#</a></h4>
<ul>
<li>White : WP Mission</li>
<li>Yellow : RTH</li>
<li>Green : Pos Hold</li>
<li>Lighter Green : Alt Hold</li>
<li>Purple : Cruise</li>
<li>Cyan : Piloted</li>
<li>Lighter cyan : Launch</li>
<li>Red : Failsafe</li>
<li>Orange : Emergency Landing</li>
</ul>
<h3 id="colour-gradients">Colour Gradients<a class="headerlink" href="#colour-gradients" title="Permanent link">#</a></h3>
<p>The RSSI and Efficiency modes are displayed using a colour gradient. Three gradients are available:</p>
<ul>
<li><strong>red</strong> : The default, white representing the best (100%), red the worst (0%)</li>
<li><strong>rdgn</strong> : Red to green, green representing the best (100%), red the worst (0%)</li>
<li><strong>yor</strong> : Yellow/Orange/Red, yellow representing the best (100%), red the worst (0%)</li>
</ul>
<p>If no option is given, <code>red</code> is assumed. Values are set by the <code>--gradient</code> command line option or  in the <a href="#setting-default-options">configuration file</a>.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">#</a></h3>
<p>Note: These images are rather old, it looks rather better now.</p>
<h4 id="flight-modes">Flight Modes<a class="headerlink" href="#flight-modes" title="Permanent link">#</a></h4>
<p><img alt="Example 1" src="https://github.com/stronnag/mwptools/wiki/images/bbl2kml-1.png" /></p>
<p><img alt="Example 2" src="https://github.com/stronnag/mwptools/wiki/images/bbl2kml-2.png" /></p>
<p><img alt="Example 3" src="https://github.com/stronnag/mwptools/wiki/images/bbl2kml-3.png" /></p>
<h4 id="rssi">RSSI<a class="headerlink" href="#rssi" title="Permanent link">#</a></h4>
<p><img alt="Example 4" src="https://github.com/stronnag/mwptools/wiki/images/inav-tracer-rssi.jpg" /></p>
<h3 id="using-opentx-logs">Using OpenTX logs<a class="headerlink" href="#using-opentx-logs" title="Permanent link">#</a></h3>
<p>There are a few issues with OpenTX logs, the first of which needs OpenTX 2.3.11 (released 2021-01-08) to be resolved:</p>
<ul>
<li>CRSF logs in OpenTX 2.3.10 do not record the FM (Flight Mode) field. This makes it impossible to determine flight mode, or even if the craft is armed. Currently <code>flightlog2kml</code> tries to evince the armed state from other data.</li>
<li>GPS Elevation. Unless you have a GPS attached to the TX, you don't get GPS altitude. This can be set by the <code>-home-alt H</code> value (in metres). Otherwise <code>flightlog2kml</code> will use an online elevation service.</li>
<li>OpenTX creates a log per calendar day (IIRC), this means there may be multiple logs in the same file. Delimiting these individual logs is less than trivial, to some degree due to the prior CRSF issue which means arm / disarm is not reliably available. Currently, <code>flightlog2kml</code> assumes that a gap of more than 120 seconds indicates a new flight. The <code>-split-time</code> value allows a user-defined split time (seconds). Setting this to zero disables the log splitting function.</li>
</ul>
<h2 id="fl2mqtt">fl2mqtt<a class="headerlink" href="#fl2mqtt" title="Permanent link">#</a></h2>
<p>The MQTT option (for BulletGCSS) uses a MQTT broker URI, which may include a username/password and cafile if required for authentication and/or encryption. It can also generate compatible log files that may be replayed by BulletGCSS' internal log player (without requiring a MQTT broker).</p>
<div class="highlight"><pre><span></span><code>$ fl2mqtt --help
Usage of fl2mqtt [options] file...
  -blt-vers int
        [MQTT] BulletGCSS version (default 2)
  -broker string
        Mqtt URI (mqtt://[user[:pass]@]broker[:port]/topic[?cafile=file]
  -dump
        Dump log headers and exit
  -home-alt int
        [OTX] home altitude
  -index int
        Log index
  -interval int
        Sampling Interval (ms) (default 1000)
  -logfile string
        Log file for browser replay
  -mission string
        Optional mission file name
  -rebase string
        rebase all positions on lat,lon[,alt]
  -split-time int
        [OTX] Time(s) determining log split, 0 disables (default 120)
</code></pre></div>
<p>The <a href="https://github.com/danarrib/BulletGCSS/wiki">BulletGCSS wiki</a> describes how the broker values are chosen; in general:</p>
<ul>
<li>It is safe to use <code>broker.emqx.io</code> as the MQTT broker, this is default if no broker host is defined in the URI.</li>
<li>You should use a unique topic for publishing your own data, this is slash separated string, for example <code>foo/bar/quux/demo</code>; the topic should include at least three elements.</li>
<li>If you want to use a TLS (encrypted) connection to the broker, you may need to supply the broker's CA CRT (PEM) file. A reputable test broker will provide this via their web site.</li>
</ul>
<p>Note that the scheme (<strong>mqtt</strong>:// in the <code>--help</code> text) is interpreted as:</p>
<ul>
<li>ws - Websocket (vice TCP socket), ensure the websocket port is also specified</li>
<li>wss - Encrypted websocket, ensure the TLS websocket port is also specified. TLS validation is performed using the operating system.</li>
<li>mqtts,ssl - Secure (TLS) TCP connection. Ensure the TLS port is specified. TLS validation is performed using the operating system, unless <code>?cafile=file</code> is specified.</li>
<li>mqtt (or any-other scheme) - TCP connection. If <code>?cafile=file</code> is specified, then that is used for TLS validation (and the TLS port should be specified).</li>
</ul>
<p>There is a <a href="https://github.com/stronnag/bbl2kml/wiki/Self-Hosting-a-MQTT-server-(e.g.-for-fl2mqtt-&amp;--BulletGCSS)">bb2kml wiki article</a> describing how to host your own MQTT broker, for reasons of convenience of better privacy.</p>
<p>Example:
<div class="highlight"><pre><span></span><code>## the default broker is used ##
$ fl2mqtt -broker mqtt://broker.emqx.io/org/mwptools/mqtt/playotx openTXlog.csv
$ fl2mqtt -broker mqtt:///org/mwptools/mqtt/playbbl blackbox.TXT

## broker is test.mosquitto.org, over TLS, needs cafile with self-signed certificate
## note the TLS port is also given (8883 in this case)
$ fl2mqtt -broker mqtt://test.mosquitto.org:8883/fl2mqtt/fl2mtqq/test?cafile=mosquitto.org.crt -mission simple_jump.mission BBL_102629.TXT
## No cafile needed, validated certificate
$ fl2mqtt -broker mqtts://broker.emqx.io:8883/fl2mqtt/fl2mtqq/test -mission simple_jump.mission BBL_102629.TXT
## Web sockets (plain text / TLS); mosquitto:8081 has valid Lets Encrypt cert.
$ fl2mqtt -broker ws://test.mosquitto.org:8080/fl2mqtt/fl2mtqq/test -mission simple_jump.mission BBL_102629.TXT
$ fl2mqtt -broker wss://test.mosquitto.org:8081/fl2mqtt/fl2mtqq/test -mission simple_jump.mission BBL_102629.TXT
</code></pre></div></p>
<p>If a mission file is given, this will also be displayed by BulletGCSS, albeit incorrectly if there WP contains types other than <code>WAYPOINT</code> and <code>RTH</code>.</p>
<p><a href="https://github.com/stronnag/mwptools">mwp</a> can also process / display the BulletGCSS MQTT protocol, using a similar <a href="https://github.com/stronnag/mwptools/wiki/mqtt---bulletgcss-telemetry">URI definition</a>.</p>
<h2 id="log2mission">log2mission<a class="headerlink" href="#log2mission" title="Permanent link">#</a></h2>
<p><code>log2mission</code> will create an inav XML mission file from a supported flight log (Blackbox, OpenTX, BulletGCSS). The mission will not exceed the inav maximum of 60 mission points.</p>
<div class="highlight"><pre><span></span><code>$ log2mission
Usage of log2mission [options] file...
  -end-offset int
        End Offset (seconds) (default -30)
  -epsilon float
        Epsilon (default 0.015)
  -index int
        Log index
  -interval int
        Sampling Interval (ms) (default 1000)
  -mode-filter string
        Mode filter (cruise,wp)
  -rebase string
        rebase all positions on lat,lon[,alt]
  -split-time int
        [OTX] Time(s) determining log split, 0 disables (default 120)
  -start-offset int
        Start Offset (seconds) (default 30)
</code></pre></div>
<ul>
<li>The <code>start-offset</code> and <code>end-offset</code> compensate for the fact that the start / end of the flight is usually on the ground, and thus is not a good WP choice. The defaults are 30 seconds for the start offset and -30 seconds (i.e. 30 seconds from the end) for the end offset. The end offset may be specified as either a positive number of seconds from the start of the log or a negative number (from the end). Locations prior to the start offset and after the end offset are not considered for mission generation. If the <code>end-offset</code> is specified (0 cancels it), and there is no flight mode filter, then RTH is included in the generated mission.</li>
<li>The <code>mode-filter</code> allows the log to filtered on Cruise and WP modes, e.g. <code>-mode-filter=cruise</code>, <code>-mode-filter=wp</code>, <code>-mode-filter=cruise,wp</code>. If <code>mode-filter</code> is specified, log entries not in the required flight mode(s) are discarded. Cruise includes both 2D and 3D cruise.</li>
</ul>
<h3 id="epsilon-tuning"><code>epsilon</code> tuning<a class="headerlink" href="#epsilon-tuning" title="Permanent link">#</a></h3>
<p>The <code>epsilon</code> value is an opaque factor that controls the point simplification process (using the Ramer–Douglas–Peucker algorithm). The default value should be a good starting point for fixed wing with reasonably sedate flying. On a multi-rotor in a small flight area, a much smaller value (e.g. 0.001) would be more appropriate.  Increasing the value will decrease the number of mission points generated. <code>log2mission</code> will do this automatically if the default value results in greater than 60 mission points, for example: the log below would generate 77 points with the default <code>epsilon</code> value.</p>
<div class="highlight"><pre><span></span><code>$ log2mission -start-offset 60 -end-offset -120 /t/inav-contrib/otxlogs/demolog.TXT
Flight   : MrPlane on 2021-04-08 13:24:07
Firmware : INAV 3.0.0 (fc0e5e274) MATEKF405 of Apr 7 2021 / 17:02:08
Size     : 19.36 MB
Log      : demolog.TXT / 1
Speed    : 28.0 m/s at 13:54
Range    : 17322 m at 14:22
Current  : 30.6 A at 00:05
Distance : 48437 m
Duration : 43:44
Altitude : 292.8 m at 25:42
Mission  : 56 points (reprocess: 1, epsilon: 0.018)
</code></pre></div>
<p>The output from this example would be <code>demolog.1.mission</code></p>
<h4 id="multirotor-example">multirotor example<a class="headerlink" href="#multirotor-example" title="Permanent link">#</a></h4>
<p>With the default <code>epsilon</code> of 0.015, for a "small field" MR flight, it is often the case that no useful mission would be generated from a such "short/complex" flight, prior to the 0.98 release auto-correction, for example:</p>
<div class="highlight"><pre><span></span><code>$ log2mission logfs.TXT
...
Mission  : 2 points
</code></pre></div>
<p>For 0.9.8, <code>log2mission</code> will make an attempt to resolve the "short/complex" 2 point results by increasing <code>epsilon</code> automatically.</p>
<div class="highlight"><pre><span></span><code>$ log2mission /t/inav-contrib/logfs.TXT
Log      : logfs.TXT / 1
...
Mission  : 14 points (reprocess: 1, epsilon: 0.001000)
</code></pre></div>
<p>Some experimentation may still be required to get a good mission, particularly for shorter MR flights. In particular, if reprocessing is indicated and the number of generated points is close to 60, then it's probably worth running again with a slightly larger epsilon than that shown in the output. Likewise, where <code>log2mission</code> has decreased the <code>epsilon</code>, it's probably worth running <code>log2mission</code> again with a slightly smaller <code>epsilon</code> than indicated.</p>
<h2 id="mission2kml">mission2kml<a class="headerlink" href="#mission2kml" title="Permanent link">#</a></h2>
<p>A standalone mission file to KML/Z converter is also provided.</p>
<div class="highlight"><pre><span></span><code>$ mission2kml --help
Usage of mission2kml [options] mission_file
  -dms
        Show positions as DMS (vice decimal degrees)
  -home string
        Use home location

The home location is given as decimal degrees latitude and
longitude and optional altitude. The values should be separated by a single
separator, one of &quot;/:; ,&quot;. If space is used, then the values must be enclosed
in quotes.

In locales where comma is used as decimal &quot;point&quot;, then comma should not be
used as a separator.

If a syntactically valid home position is given, without altitude, an online
elevation service is used to adjust mission elevations in the KML.

Examples:
    -home 54.353974/-4.5236
    --home 48,9975:2,5789/104
    -home 54.353974;-4.5236
    --home &quot;48,9975 2,5789&quot;
    -home 54.353974,-4.5236,24
</code></pre></div>
<p>A KML file is generated to stdout, which may be redirected to a file, e.g:</p>
<div class="highlight"><pre><span></span><code>$ mission2kml -home 54.125229,-4.730443 barrule-h.mission &gt; mtest.kml
</code></pre></div>
<p>Note that for recent MW-XML mission files generated by <a href="https://github.com/stronnag/mwptools">mwp</a> or the inav-configurator, the planned home located may be saved in the mission files; in which csae it will be used.</p>
<h2 id="setting-default-options">Setting default options<a class="headerlink" href="#setting-default-options" title="Permanent link">#</a></h2>
<p>Default settings may be set in a JSON formatted configuration file.</p>
<ul>
<li>On POSIX platforms (Linux, FreeBSD, MacOS), <code>$HOME/.config/fl2x/config.json</code></li>
<li>On Windows <code>%APPDIR%\fl2x\config.json</code></li>
</ul>
<p>The keys in the file are the relevant command line options, the following are recognised:</p>
<ul>
<li><code>dms</code></li>
<li><code>extrude</code></li>
<li><code>kml</code></li>
<li><code>rssi</code></li>
<li><code>efficiency</code></li>
<li><code>split-time</code></li>
<li><code>home-alt</code></li>
<li><code>blackbox-decode</code></li>
<li><code>gradient</code></li>
<li><code>outdir</code></li>
<li><code>blt-vers</code></li>
<li><code>type</code></li>
<li><code>visibility</code></li>
<li><code>energy-unit</code></li>
</ul>
<p>For example:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;dms&quot;: true,
    &quot;extrude&quot;: true,
    &quot;gradient&quot;: &quot;yor&quot;,
    &quot;efficiency&quot;: true
}
</code></pre></div>
<p>A warning will be displayed if the configuration file in not syntactically correct; in such cases its contents will be ignored. There is a somewhat <a href="https://github.com/stronnag/bbl2kml/wiki/Sample-Config-file">complete example</a> in the wiki that can be used as a template.</p>
<p>Note also that the command interpreter allows <code>-flag</code> or <code>--flag</code> for any option.</p>
<h2 id="limitations-bugs-bug-reporting">Limitations, Bugs, Bug Reporting<a class="headerlink" href="#limitations-bugs-bug-reporting" title="Permanent link">#</a></h2>
<p><code>flightlog2kml</code> aims to support as wide a range of inav firmware and log decoders as possible. During its development, inav has changed both the data logged and in some cases, the meaning of logged items; thus for versions of inav prior to 2.0, the reported flight mode might not be completely accurate. <code>flightlog2kml</code> is known to work with logs from 2015-10-30 (i.e. pre inav 1.0), and if you have a Blackbox log that is not decoded / visualised correctly, please raise a <a href="https://github.com/stronnag/bbl2kml/issues">Github issue</a>; this is a bug.</p>
<p>Due to the range of <code>inav</code> versions, <code>blackbox_decode</code> versions and supported operating systems, when reporting bugs, please include the following information in the Github issue:</p>
<ul>
<li>The version of <code>flightlog2kml</code> and <code>blackbox_decode</code>. Both applications have a <code>--help</code> option that should give the version numbers.</li>
<li>The host operating system and version (e.g. "Debian Sid", "Windows 10", "MacOS 10.15").</li>
<li>Provide the blackbox log that illustrates the problem. If you don't want to post the log into an essentially public forum (the Github issue), then please propose a private delivery channel.</li>
</ul>
<p>Replaying Ardupilot logs requires <a href="https://github.com/ArduPilot/pymavlink">mavlogdump.py</a>.</p>
<h2 id="build-and-install">Build and Install<a class="headerlink" href="#build-and-install" title="Permanent link">#</a></h2>
<h3 id="release-media">Release media<a class="headerlink" href="#release-media" title="Permanent link">#</a></h3>
<p>Binaries are provided for common operating systems in the <a href="https://github.com/stronnag/bbl2kml/releases">Release folder</a>.</p>
<h3 id="building-from-source">Building from source<a class="headerlink" href="#building-from-source" title="Permanent link">#</a></h3>
<p>Requires Go v1.13 or later.
Compiled with:</p>
<div class="highlight"><pre><span></span><code>$ go build cmd/flightlog2kml/main.go
$ go build cmd/mission2kml/main.go
</code></pre></div>
<p>or more simply</p>
<div class="highlight"><pre><span></span><code># First time
meson build --prefix=~/.local
cd build
ninja install
</code></pre></div>
<div class="highlight"><pre><span></span><code># Subsequently
cd build
ninja install
</code></pre></div>
<p><strong>flightlog2kml</strong> depends on <a href="https://github.com/twpayne/go-kml">twpayne/go-kml</a>, an outstanding open source Golang KML library.</p>
<p><code>flightlog2kml</code> may be built for all OS for which a suitable Golang is available. It also requires inav's <a href="https://github.com/iNavFlight/blackbox-tools">blackbox_decode</a>; the latest version is recommended; the minimum <code>blackbox_decode</code> version is 0.4.4. For Windows' users it is probably easiest to copy inav's <code>blackbox_decode.exe</code> into the same directory as <code>flightlog2kml.exe</code>.</p>
<div class="admonition note">
<p class="admonition-title">Notes</p>
</div>
<ul>
<li><code>fl2ltm</code> is a link to <code>fl2mqtt</code></li>
<li><code>bbsummary</code> is a link to <code>flightlog2kml</code> and will behave as <code>flightlog2kml -summary</code>.</li>
<li><code>fl2ltm</code> will be automatically detected by <a href="https://github.com/stronnag/mwptools">mwp</a> and used in preference to its older <code>replay_bbox_ltm.rb</code> and <code>otxlog</code> helpers.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>